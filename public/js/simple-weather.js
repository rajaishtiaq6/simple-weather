(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function s(t,a,i,o){var s=a&&a.prototype instanceof h?a:h,u=Object.create(s.prototype);return r(u,"_invoke",function(t,r,a){var i,o,s,h=0,u=a||[],l=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,r){return i=t,o=0,s=e,d.n=r,c}};function m(t,r){for(o=t,s=r,n=0;!l&&h&&!a&&n<u.length;n++){var a,i=u[n],m=d.p,p=i[2];t>3?(a=p===r)&&(s=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=e):i[0]<=m&&((a=t<2&&m<i[1])?(o=0,d.v=r,d.n=i[1]):m<p&&(a=t<3||i[0]>r||r>p)&&(i[4]=t,i[5]=r,d.n=p,o=0))}if(a||t>1)return c;throw l=!0,r}return function(a,u,p){if(h>1)throw TypeError("Generator is already running");for(l&&1===u&&m(u,p),o=u,s=p;(n=o<2?e:s)||!l;){i||(o?o<3?(o>1&&(d.n=-1),m(o,s)):d.n=s:d.v=s);try{if(h=2,i){if(o||(a="next"),n=i[a]){if(!(n=n.call(i,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,o<2&&(o=0)}else 1===o&&(n=i.return)&&n.call(i),o<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=e}else if((n=(l=d.n<0)?s:t.call(r,d))!==c)break}catch(t){i=e,o=1,s=t}finally{h=1}}return{value:n,done:l}}}(t,i,o),!0),u}var c={};function h(){}function u(){}function l(){}n=Object.getPrototypeOf;var d=[][i]?n(n([][i]())):(r(n={},i,(function(){return this})),n),m=l.prototype=h.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,r(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=l,r(m,"constructor",l),r(l,"constructor",u),u.displayName="GeneratorFunction",r(l,o,"GeneratorFunction"),r(m),r(m,o,"Generator"),r(m,i,(function(){return this})),r(m,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:s,m:p}})()}function r(e,t,n,a){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}r=function(e,t,n,a){if(t)i?i(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n;else{var o=function(t,n){r(e,t,(function(e){return this._invoke(t,n,e)}))};o("next",0),o("throw",1),o("return",2)}},r(e,t,n,a)}function n(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,r||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}var o=function(){return e=function e(t,r){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elementId=t,this.atts=r,this.weatherFeed=a,this.currentWeather=null,this.error=null,this.loading=!0,this.element=document.getElementById("simple-weather--".concat(this.elementId)),this.i18n=(null===(n=window.SimpleWeather)||void 0===n?void 0:n.i18n)||{loading:"Loading weather...",errorLoadData:"Could not load weather data",errorConnect:"Could not connect to weather service",current:"Current",humidity:"Humidity",clouds:"Clouds",wind:"Wind"},this.init()},r=[{key:"init",value:function(){this.element&&(this.weatherFeed?(this.processWeatherData(this.weatherFeed),this.render()):this.fetchWeather())}},{key:"fetchWeather",value:(o=t().m((function e(){var r,n,a,i;return t().w((function(e){for(;;)switch(e.n){case 0:return this.loading=!0,this.render(),e.p=1,n=(null===(r=document.querySelector('meta[name="csrf-token"]'))||void 0===r?void 0:r.getAttribute("content"))||this.getCookie("XSRF-TOKEN"),e.n=2,fetch(window.SimpleWeather.apiUrl,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":n},body:JSON.stringify(this.atts)});case 2:return a=e.v,e.n=3,a.json();case 3:(i=e.v).error&&i.data&&i.data.error?this.error=i.data.message||this.i18n.errorLoadData:i.error?this.error=i.message||this.i18n.errorLoadData:i.data&&i.data.error?this.error=i.data.message||this.i18n.errorLoadData:this.processWeatherData(i.data||i),e.n=5;break;case 4:e.p=4,e.v,this.error=this.i18n.errorConnect;case 5:return e.p=5,this.loading=!1,this.render(),e.f(5);case 6:return e.a(2)}}),e,this,[[1,4,5,6]])})),s=function(){var e=this,t=arguments;return new Promise((function(r,a){var i=o.apply(e,t);function s(e){n(i,r,a,s,c,"next",e)}function c(e){n(i,r,a,s,c,"throw",e)}s(void 0)}))},function(){return s.apply(this,arguments)})},{key:"processWeatherData",value:function(e){e.current&&(this.currentWeather=e.current),e.daily&&(this.weatherFeed=e.daily)}},{key:"render",value:function(){if(this.element)if(this.loading)this.element.innerHTML='<div class="simple-weather__loading">'.concat(this.i18n.loading,"</div>");else if(this.error)this.element.innerHTML='<div class="simple-weather__error">'.concat(this.error,"</div>");else{var e=this.atts.style||"default",t="metric"===this.atts.units?"C":"F",r="metric"===this.atts.units?"km/h":"mph";this.element.innerHTML="widget"===e?this.renderWidget(t,r):this.renderDefault(t)}}},{key:"renderDefault",value:function(e){var t=this,r="";if(this.atts.location&&(r+='<div class="simple-weather__location">'.concat(this.atts.location,"</div>")),this.currentWeather&&this.currentWeather.dt){var n="yes"===this.atts.show_units;r+='<span class="simple-weather__day simple-weather__day--current">',r+='<span class="simple-weather__date">'.concat(this.i18n.current,"</span>"),r+='<i class="sw '.concat(this.getWeatherIcon(this.currentWeather),'"></i>'),r+='<em class="simple-weather__temp">'.concat(this.formatTemp(this.currentWeather.temp)," &deg;").concat(n?e:"","</em>"),r+="</span>"}if(this.weatherFeed&&Array.isArray(this.weatherFeed)){var a=parseInt(this.atts.days||1),i="yes"===this.atts.show_date,o="yes"===this.atts.show_units;this.weatherFeed.forEach((function(n,s){s<a&&n.dt&&(r+='<span class="simple-weather__day">',i&&(r+='<span class="simple-weather__date">'.concat(t.formatDate(n.dt,t.atts.date),"</span>")),r+='<i class="sw '.concat(t.getWeatherIcon(n),'"></i>'),r+='<em class="simple-weather__temp">'.concat(t.formatTemp(n.temp.max)," &deg;"),n.temp.min&&(r+='<em class="simple-weather__temp-min">'.concat(t.formatTemp(n.temp.min)," &deg;</em>")),r+="".concat(o?e:"","</em>"),r+="</span>")}))}return r}},{key:"renderWidget",value:function(e,t){var r=this,n='<div class="simple-weather-widget">';if(this.atts.location&&(n+='<h4 class="widget_title">'.concat(this.atts.location,"</h4>")),this.currentWeather&&(n+='<div class="temp">',this.currentWeather.temp&&(n+='<span class="degrees">'.concat(this.formatTemp(this.currentWeather.temp)," &deg;</span>")),n+='<span class="details">',this.currentWeather.humidity&&(n+="".concat(this.i18n.humidity,': <em class="float-right">').concat(this.currentWeather.humidity,"%</em><br>")),this.currentWeather.clouds&&(n+="".concat(this.i18n.clouds,': <em class="float-right">').concat(this.currentWeather.clouds,"%</em><br>")),this.currentWeather.wind_speed&&(n+="".concat(this.i18n.wind,': <em class="float-right">').concat(this.currentWeather.wind_speed,"<small>").concat(t,"</small></em>")),n+="</span></div>",this.currentWeather.weather&&this.currentWeather.weather[0]&&(n+='<div class="summary">'.concat(this.currentWeather.weather[0].description,"</div>"))),this.weatherFeed&&Array.isArray(this.weatherFeed)){var a=parseInt(this.atts.days||1);n+='<div class="simple-weather-table">',this.weatherFeed.forEach((function(e,t){t<a&&e.dt&&(n+='<div class="simple-weather-table__row">',n+='<div class="simple-weather-table__date">'.concat(r.formatDate(e.dt,r.atts.date),"</div>"),n+='<div class="simple-weather-table__icon"><i class="sw '.concat(r.getWeatherIcon(e),'"></i></div>'),n+='<div class="simple-weather-table__temp">'.concat(r.formatTemp(e.temp.max),"&deg;"),n+='<span class="simple-weather-table__temp-min">'.concat(r.formatTemp(e.temp.min)," &deg;</span>"),n+="</div></div>")})),n+="</div>"}return n+="</div>"}},{key:"getWeatherIcon",value:function(e){if(!e||!e.weather||!e.weather[0])return"wi-day-sunny";var t=e.weather[0].id;return this.mapWeatherCodeToIcon(t)}},{key:"mapWeatherCodeToIcon",value:function(e){return e>=200&&e<300?"wi-thunderstorm":e>=300&&e<400?"wi-sprinkle":e>=500&&e<600?"wi-rain":e>=600&&e<700?"wi-snow":e>=700&&e<800?"wi-fog":800===e?"wi-day-sunny":e>800?"wi-cloudy":"wi-day-sunny"}},{key:"formatTemp",value:function(e){return Math.round(e)}},{key:"formatDate",value:function(e,t){var r=new Date(1e3*e);return"dddd"===t?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r.getDay()]:r.toLocaleDateString()}},{key:"getCookie",value:function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===t.length?decodeURIComponent(t.pop().split(";").shift()):null}}],r&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,i,o,s}();function s(){void 0!==window.SimpleWeatherAtts&&Object.keys(window.SimpleWeatherAtts).forEach((function(e){var t=window.SimpleWeatherAtts[e],r=window.SimpleWeatherFeeds?window.SimpleWeatherFeeds[e]:null;new o(e,t,r)}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s(),window.initSimpleWeather=s})();